<!DOCTYPE html>
<html ng-app="Test">
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"href="theme.css">
    
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js"></script>
 
  
</head>

<body>

<br>
<h1>Welcome to Fair Fare!</h1>
<br>
<br>

   	
<div id="addressform" ng-controller="TestCtrl">
<h1>Compare the Best Fare</h1>
<form id="form" role="form">
     <input type="text" id="name" placeholder="NAME"  />
     <input type="text" id="autocomplete" placeholder="PICKUP LOCATION"/>
     <input type="text" id="autocomplete" placeholder="DROPP OFF LOCATION"/>
     <input type="reset" name="Save" value="Save" onclick="codeAddress()"/>
    <input type="submit" name="Get Fare Estimates" value="Get Fare Estimates" />

</form>
</div>



<script>
 function initialize() {
    autocomplete = new google.maps.places.Autocomplete(
            /** @type {!HTMLInputElement} */(document.getElementById('autocomplete')),
            {types: ['geocode']});
			
    geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(-34.397, 150.644);
    var mapOptions = {
      zoom: 8,
      center: latlng
    }
    map = new google.maps.Map(document.getElementById('map'), mapOptions);
  }
function codeAddress() {
    var name = document.getElementById('name').value;
	var address = document.getElementById('autocomplete').value;

	geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == 'OK') {
	  var obj = new Object();
   obj.name = name;
   obj.address  = results[0].address_components[0].long_name +" "+ results[0].address_components[1].long_name;
   obj.city = results[0].address_components[3].short_name;;
   obj.state = results[0].address_components[5].short_name;
   obj.zip = results[0].address_components[7].long_name;
   var jsonString= JSON.stringify(obj);
xhr = new XMLHttpRequest();
var url = "http://127.0.0.1:7000/locations";
xhr.open("POST", url);
xhr.setRequestHeader("Content-type", "application/json");
xhr.send(jsonString); 
       
        
      } else {
        alert('Geocode was not successful for the following reason: ' + status);
      }
    });
  }
  </script>

  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAoKeFrswJ6Btx3tQLF6eN-wE3Iej0WF3Q&libraries=places&callback=initialize">
    </script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	
</body>
</html>

